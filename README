Shica -W-

structure
UI main component
|- editor component
|- output component
|- map component
|
|- agents
|  |- robot agent (vacuum cleaner)
|  |- js agent (user can change the web component)



WEB Shica TO DO LIST

# vm.leg
|-add more web event handler and function
|   |- change the speed
|   |- ditect collision
|   |- ditect touch
|   |- trigger web timer
|   |- change the rober color
|
|-add original shica feature
|   |- state transition
|   |- event condition
|   |- event definition
|   |- AOP
|
|-run multiple agent
|   |- sotre one or more codes
|   |- store one or more argents 
|   |- combine web 

#Index.html
|- editorを追加したらエージェントも追加
|- agentの要素に色をつける、LEDもつけるon/off



# Shica - Web Test Framework
web shica can use integer value

TODO
- arguments condtions
- multiple event handlers


NOT YET
- strings
- numbers
- user-defined function
- arrays

# WASM
	emcc handler.c \
     -o handler.js \
     -s WASM=1 \
     -s EXPORTED_RUNTIME_METHODS="['cwrap', 'HEAP32', 'getValue', 'setValue']"\
     -s EXPORTED_FUNCTIONS="['_initWebTimerPtr', '_setWebTimer', '_getWebTimerPtr', '_initWebClickSTTPtr', '_getWebClickSTTPtr', '_initALLAgentDataPtr', '_getAllAgentDataPtr', '_getAllAgentDataSizePtr' ,'_testAllEventHandlers']" 

	emcc vm.c 
    -o vm.js 
    -s MODULARIZE=1 
    -s EXPORT_NAME="'vm'" 
    -s "EXPORTED_FUNCTIONS=['_store', '_web_compile', '_web_compile_size',          '_web_vm_execute', '_web_vm_execute_size', '_malloc', '_free']" 
    -s "EXPORTED_RUNTIME_METHODS=['ccall', 'cwrap', 'allocateUTF8', 'HEAP32']" 
    -s ENVIRONMENT='web' -O0

    emcc vm.c \
    -o vm.js \
    


# vms
S [number of Eventhandler]
    E [libray number] [clone number + G-L bool + number of process]
        P [pPos] [cPos]
        P [pPos] [cPos]
    E [libray number] [clone number + G-L bool + number of process]
        P [pPos] [cPos]
        P [pPos] [cPos]


# user-define function call

func(1,2)

s00: rbp s00
s01: arg 2
s02: arg 1
s03: rpc x
s04: rbp s00
s05: var 1
s06: var 2




# MSGC

# compile
    step 0
        define gc_markFunction_t    gc_markFunction    = markObject;
        define gc_collectFunction_t gc_collectFunction = collectObjects;
        set collectObjects() that includes
            - bytefiles
            - sysmbols
    step 1
        call markObject(webSize)
    step 2


# execute
    step 1
        define gc_markFunction_t gc_markFunction       = markIntarray;
        define gc_collectFunction_t gc_collectFunction = collectIntArray;
        set collectIntArray() that includes
            - bytefiles
            - vms
    step 2
        call gc_collect()



